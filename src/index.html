<html dir="ltr" lang="en">
  <head>
    <script type="module" src="/build/wc-gocam-viz.esm.js"></script>
    <script nomodule src="/build/wc-gocam-viz.js"></script>

    <script type="module" src="https://unpkg.com/@geneontology/wc-light-modal/dist/wc-light-modal/wc-light-modal.esm.js"></script>
    <script nomodule="" src="https://unpkg.com/@geneontology/wc-light-modal/dist/wc-light-modal/wc-light-modal.js"></script>      

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <style>
      .pop-line {
          line-height: 1.1rem;
          text-decoration: none;
      }

      .span-left {
          margin-left: 0.5rem;
      }

      .span-right {
          margin-left: 0.5rem;
          margin-right: 0.5rem;
      }    
    </style>

  </head>
  
  <body>
      

      <!-- <wc-gocam-viz 
        gocam-id="gomodel:5f46c3b700000827"
        show-has-input=false
        show-activity=false
      /> -->

    
    <!-- <wc-gocam-viz 
      gocam-id="gomodel:5e72450500004237"
      show-has-input=false
      show-activity=false
    /> -->

    <!-- <wc-gocam-viz 
      gocam-id="gomodel:5f46c3b700001031"
      show-has-input=true
      show-has-output=true
      show-activity=false
    /> -->

    <!-- <wc-gocam-viz 
      gocam-id="gomodel:5f46c3b700002146"
      show-has-input=false
      show-has-output=false
      show-activity=false
    /> -->

    <!-- <wc-gocam-viz 
      gocam-id="5e72450500004019"
      show-has-input=false
      show-has-output=false
      show-gene-product=false
      show-activity=true
    /> -->

    <wc-gocam-viz 
      id="gocam-1"
      gocam-id="568b0f9600000284"
      show-has-input=false
      show-has-output=false
      show-gene-product=true
      show-activity=false
      style="position: fixed; top: 50%; left: 10%; transform: translate(0%, -50%); width:1900px;"
    ></wc-gocam-viz>

    <wc-light-modal modal-anchor="@" modal-content="<button>toto</button>" x=0 y=0 id="modal-1">
    </wc-light-modal>

    <script>

        function lineStyle() {
          return "line-height: 1.2rem; padding: 0.2rem;"
        }

        function leftStyle() {
          return "margin-left: 0.5rem; margin-right: 0.5rem; width: 5rem; display: inline-block;"
        }
        function leftStyle2() {
          return "margin-right: 0.5rem; width: 5rem; display: inline-block;"
        }

        function rightStyle() {
          return ""
        }

        function articleStyle() {
          return " box-sizing: border-box; text-decoration: none; color: black; margin-left: 0.5rem; -webkit-box-shadow: 4px 6px 42px 0px rgb(194 194 194); -moz-box-shadow: 4px 6px 42px 0px rgba(194,194,194,1); box-shadow: 4px 6px 42px 0px rgb(194 194 194); border: 1px solid green; display: inline-block; width: 20px; border-radius: 5px; background-color: greenyellow; text-align: center;"
        }

        function listReferences(context) {
          // console.log("context: ", context);
          // return "<i class=\"far fa-newspaper\"></i>"
          
          let html = "";
          for(let i = 0; i < context.evidences.pmid.length; i++) {
            html += "<a href='" + context.evidences.url[i] + "' style='" + articleStyle() + "' target='_blank' title='Source: " + context.evidences.pmid[i] + "\nEvidence: " + context.evidences.label[i] + "'>R</a>";
          }
          return html;
        }

        function createContent(payload) {
          let content = "";
          content += "<div class='pop-line' style='" + lineStyle() + "'><span class='span-left' style='" + leftStyle() + "'>Gene</span><a href='" + payload.meta.url + "' class='span-right' target='blank' style='" + rightStyle() + "'>" + ((payload && payload.meta && payload.meta.label && payload.meta.label.length > 0) ? payload.meta.label[0] : "N/A") + "</a></div>";
          content += "<div class='pop-line' style='" + lineStyle() + "'><span class='span-left' style='" + leftStyle() + "'>Taxon</span><a href='" + payload.meta.taxon_url + "' class='span-right' target='blank' style='" + rightStyle() + "'>" + payload.meta.taxon_label + "</a></div>";
          if(payload.standardTypes && payload.standardTypes.length > 0) {
            content += "<div class='pop-line' style='" + lineStyle() + "'><span class='span-left' style='" + leftStyle() + "'>Activity</span><a href='http://amigo.geneontology.org/amigo/term/" + payload.standardTypes[0].class_id() + "' class='span-right' target='blank' style='" + rightStyle() + "'>" + payload.standardTypes[0].class_label() + "</a></div>";
          }
          for(let contexts of Object.keys(payload.biocontext)) {
            if(contexts == "RO:0002333") continue;  // discard enabled_by info
            for(let context of payload.biocontext[contexts]) {
              content += "<div class='pop-line' style='" + lineStyle() + "'><span class='span-left' style='" + leftStyle2() + "'></span><span class='span-left' style='" + leftStyle() + "'>" + context.relationLabel + "</span><a href=" + context.termURL + " class='span-right' target='blank' style='" + rightStyle() + "'>" + context.termLabel + "</a>" + listReferences(context) + "</div>";
              
            }
          }
          return content;
        }

        document.addEventListener('nodeOver', function hideMenu(e, v) {
          let payload = e.detail;
          // console.log('Node over' , payload);
          let modal = document.getElementById("modal-1");
          modal.x = payload.x;
          modal.y = payload.y;
          modal.modalTitle = payload.label;
          modal.modalContent = createContent(payload);
          
          // modal.open();
        });

        document.addEventListener('nodeOut', function hideMenu(e, v) {
          // console.log('Node out' , e.detail);
          let modal = document.getElementById("modal-1");
          // modal.close();
        });
        
    </script>
    

    <!-- <wc-gocam-viz 
      gocam-id="5f46c3b700002102"
      show-has-input=false
      show-has-output=false
      show-activity=false
    /> -->

    


  </body>
</html>
